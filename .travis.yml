language: python
sudo: false

python:
  - "2.7"
  - "2.6"
  - "3.2"
  - "3.3"
  - "3.4"
  - "3.5"

addons:
  apt:
    sources:
      - couchbase-precise
    packages:
      - libcouchbase-dev
      - libcouchbase2-libevent
      - libevent-dev

install:
  - pip install -U pip
  - pip install gevent || echo "Couldn't find gevent"
  # Twisted install can fail, as Twisted requires Python 2.7 or later
  - pip install twisted || echo "Couldn't install twisted"
  - pip install testresources
  - export CFLAGS='-Wextra -Wno-long-long -Wno-missing-field-initializers'
  - CFLAGS="$CFLAGS -fno-strict-aliasing -Wno-strict-aliasing"
  - python setup.py build_ext --inplace
  - python setup.py install

script:
  - ./.ci_script.sh

notifications:
  email:
    - mark.nunberg@couchbase.com
